"""
代码封装至register_function中,基于register_code基础

"""
import sys
sys.path.append("F:\Projects\Projects\Mooc_TestProject")
from selenium import webdriver
import time
import random
from PIL import Image
from find_element import FindElement
from ShowapiRequest import ShowapiRequest

'''
class RegisterFunction(object):
    def __init__(self, url, i):
        self.driver = self.get_driver(url, i)

    # 获取driver并且打开url
    def get_driver(self, url, i):
        if i == 1:
            driver = webdriver.Chrome()
        elif i == 2:
            driver = webdriver.Firefox()
        else:
            driver = webdriver.Edge()
        # driver = webdriver.Chrome()
        driver.get(url)
        driver.maximize_window()
        return driver

    # 输入用户信息
    def send_user_info(self, key, data):
        self.get_user_element(key).send_keys(data)

    # 定位给用户信息，获取element
    def get_user_element(self, key):
       find_element = FindElement(self.driver)
       user_element = find_element.get_element(key)
       return user_element

    # 获取随机数
    def get_range_user(self):
        user_info = ''.join(random.sample("1234567890abcdefghijklmn", 8))
        return user_info

    # 获取图片
    def get_code_image(self, file_name):
        self.driver.save_screenshot(file_name)
        code_element = self.get_user_element("code_image")
        print(code_element.location)
        left = code_element.location['x']
        top = code_element.location['y']
        right = code_element.size['width'] + left
        height = code_element.size['height'] + top
        im = Image.open(file_name)
        img = im.crop(left, top, right, height)
        img.save(file_name)

    # 解析图片获取验证码信息
    def code_online(self, file_name):
        self.get_code_image(file_name)
        r = ShowapiRequest("http://route.showapi.com/184-5", "96517", "213a7970dd72492aaaee595c9d64f7d9")
        r.addBodyPara("img_base64",
                      "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIEAAAAoCAYAAADZs5l2AAAmqElEQVR4nMW8eZBd133f+fmdc+69b+m9ge4GGmsDIAgCJMF9k0hRlGRbkp1IcqzUOPFkMi5Xav6dTM1MpWYqmarx1LgqVZmMK8vE8czETuwqyZEiK9ZOkeIOEuACEjuxA43et9dvufee85s/zm0QtJZEMGt0qrr79Xv33nfv+X3Pb/3+jsz4N5SfewREffVaULGgloAFLKipPlKMBpASRQkieLGYYPFaoqZLKp7Mg1eHsSmJ5njjWcpXSbIBSnVYTckMiF/BqGJNjY4PqLMEcRAsGRllsU6WQp4HbOLwpo2gqBoIFicJiiGUJSYE0iyh9AXOOPK8xNoELwaVQBBFRTHqUQHFoAhGDQoEAasKBFQUkRKjCiGNc4CClHEe1IAISA6SIwQIKap1VISAAc2qc3pgcsAjIQUEQwFSIqqgNdAEFQ8S4uWrnw8PBVFEQSqZxeF+7Mgff+c/awiIAdX4GgXxiAqKIiK3HBrizYuiGl9bY7AIJQZVTxmUoJ6gJc4IRe5JkybdoBjJCFKj7Xs0TJOe72KDJVhHgaA4jCS0PRhjsJQYC8GXqIKIxRgHCMErSMAYQ2ItZVngNaAhxyZpdbze/ItqnEAFlY3JjM8st0y7oPEYJApbBWRjbgARZOMCKjfPiucFTPV3Q3Cqt4pUUEz8u3Edbpnfn2uYn/jubYNAtUI7cbIQj0h8EKmOAdmYM4SN9aGY0EMBYwVLiljFqlCWAcRiJAMcXoRWaShKyHNlqOlITIOMGj3xXLx2jU7X02wMkGUZW4abSMhJRUnEodTRAKoCqiihAmlcF149xlhUA0FCfBoVpML1TRkCsgGI6n+9+b9Wvw2hWhxaTfYHQBGMgKiJi2fjKqoYKavXpnrLo2g1s4IiBDFRVKKIWASD+UtA+HFYxLm/9R5+2rh9EBDRLlQrPU5rBYRwy4PZSiVVty0gocQHAIuQYBDECN6UBCxiaqx2St6fnuP87DxLrZIiLxjdbNkxNsa20Ulco8ZLb53m0sXr9A8OMja+mc899QhDDhIJ2EqLFB48JZhAlEQgEFAN1e3F+yxCiTUWrx6HrQRfPavoLWsornqRDSVcaQExiJqbS4DKhIhunKUIhrgUZGMiEDxGNQJHDYonyAawNuba3PxuFYOptIl8SEP9ZDndvOePGgSqUTVtXDj+NkThbyAvql4JBqrJ0OozY+NZZSkUvsQXijiDzVJ8cLQLx+mLM/zRv/8Gr719nBvzyyie0YkaD91/mKcefZqpPft5/tV3eeXl11At2HPnbh66/06GNtWRoOS9nNTVMEEI1cpXibcZVG9qgF4ocCal1BIrNdTkG1q50twfVgtRPhvq+4MR/YO4GIIEUAjILVNffbm6m8KtJiXOS1QvfCCsD840Gv2T6IuFD2mgj2LcHghkY60LEqIzKMHGhxIPlNVNw01HUQ1GlFJLirIgdQ3qpp/W6iqXT11g85bNNDYPQ62PK8tt/uBPvsnLr7/HeqdDvZaR1ZWFhXmeff4VXnnxFNbW6XS75F2Ls4E0SRgeGkS1xJeW/lofnfUWaZZircHjKSthBqJ6t+LABjyGYCzrvkdi7S043gA7oKY6UzEaFXUQra5osMHj1N90GgMGL3EBfCBQi2IBUzmegWBC1KbBVmZoY3HF74EQHUAtEQ3R0VYbTcWG6/ET5PPBkJvPDD/ZK7g9EBBV6U2vN8QHE63sqggQX1NNRNgwH2IRlB4eEwrqWY09O3dTSEkeoFN6/tm/+be8evQ46+2Svdt289ijBxmb7OP66hxH3zzB+TOztNsriMtIbANLh7pNyazDSkDEUYZA1shQCXgCJYIXh2AoJUGAQgMGiwLONOgVbRo2I0gPUwEg2mO5KSC56Yt/2NZK9fxRxccFYm6x7h9Ix6EStaaKr+bKYUQQBVNpB+QDMETvIALAVBrH47hVW/xVxu35BOKJuqCy+bd4rRuhVLjpkggiJmoNfLxtI3gNBMnJ0oT6cB9rvksndRw9d4YfHjvCQmuV4WSATz/yMJ/99KP0jTjmixYHdu3n9aOnef6lt5hfWscEiwSh4Wo4JE6NoVLzIWoATfEmJRcHOASLV6X0XVIRxMT1bG2dIihOhCCCisFjAeJTVR6jVE7dTd8oWvboFIpHRW/RAvHTGGnExYEKIh6hJBAqXyFEmQa9+R0fwCeaEq0ilzh+hp3/0Efyl/7/cdVxm46hAr4SdfwiqVa7iuCFGG/f/CwCwYSYN/DEWFytxysUoSRkljxxfOu1F5lZmUPSlL3bxnjynoPs2zRCbciwJRlg7+Qupib3cmNujaUj76I+IF7przVwCkbDTTVbUBLU4NWw3Mq5vjhPq9UjoUYvlBR5h5SAtQGRgnvuuotCSqypvHIsXhyKYDXmAjbUtNkAygbwjcGroEbi9+MQlbiCCdFhDhvxEQTRKiKJoo45iQ8U9wcWqVpcYiphVhLVn64Fbg1rK3X8l2T3kYCgcnI2vNyNVS8a/QWBUirbi0GIYY01jiCOkhJPiQW88RRW6dqUVV/y7Cuv4DttskbGE48cZttok5mL59h551bqNsOYwN1Tu7nv4EHefPssvuhhcAwNNnECpS8Q4zE2paCOD46ltTZvn36f518+yvlzV0ETeiEQihzptjEmp9k0/N7v/kO2jgwRtEsIiopQGIfiAM+GWTBGkQBe9OY8KAaVarWKJWDisdWqFiAEJe+V4BLEJmilGS1S+YkxfJUPCU7hVrBVHquK8NNh8PON2wKBqEM0QTTGq8EHUI/LMgpKvAg9LRFJKTRQl5hF60nAUkcIeNpAjpcCHBQinLlwlZW5VUhqDPTXmdo5zp6pCSQMUtDDFAX1JKMoSurWYa2jKx2SmmFk8xCm0i4WoR08wYxyY3WVr3/tuzz74ktcvbGA7wndjhDSDBuUzOcYWeeOfePkeY7iUVXml5aw2QDpQH81TYEQFGtjpGks9MqcxCUQhKARFBuJnU4IpCbFErVBqYH5pTVefu0426buZNe+3djEUAOSUFAzFqUXFwtE0yNKWQRqSY1cK1e8ykflRUma1ghBCb68+f6tvkpM3t2UGj9JC/wVQGAwYqv8gEbvW5U8BHoK3iZ0S2Gl3WZ2YZHZq3OsLK3isjqNRn/UG9pmz84R7tyxBQngkjpnT16kzB0Epa9eZ+u2MUwWIHgcQtHrcOP6AoPjeykLjy+KqHXwjI+PVqrXkmtApI8Xj73Hn3zl61y6cI6ZhVlsVmN0dAxj+jh7bR5bBIQE9fA3/sZvMjwwgCHgRblw+TLf/M4LzHcC45M7Obh7ivGJEcbG+tmxaRBxgrUJpSqJSfDB0AVKVYrcM7O4ysyN64yN9rFrxziJZCy3F/ne8y/S+eHrjO/cyradExzau5eDU7sYrSekAiol3nvEx1Cz5jK6vouxFlXIixxrhNQ16ORdUpdgJKbhE2PwIXw4Y/ufMW4PBOIr5zWg6jHiUFWCWJSM0xevc+y901yanmFpYZnZG/N02x1skmHTGs5ZRNfZPzXE3//tv0MNh/UZV85MY4oaEgyNeoPRiU3kpsBQkFrBF0Ity7gxO8ulS1fwQcAYjIUtoyPEDFSKSsLLb5zi337tuxw9dpytY3185peeYuvkVgbro6y1hN//f/4M7xUfAtbV2HfHfvrqdVTXCeoZHtnE5vGtPPed5zh68iKnJs4yMtJg/4Ed/NonP8busdEYGGmglxecvTrLyas3mJ5dYnFpmdXVdXqdFT799MPs3L4VBTYNjPLIw4/ytb94jhMXLjI8NsQ74yfYP7Wb+/ZP8fA9+xmpp1hClQKHIuQggvcBa1KMKCKBUOUwvCrWRBusqj8DAD89r3CbPkEsIIkJaAgE1VgEMQmLiz2+++wRvv/Ca1yenqXoFdQSR1+jQV4GWr0cH0pCWGdpeYgSi5UUGxxL11exeYoYyGoNmoN9FKYgoUAxJKljZNMAZ09dY3putrKohsQ6JkfHccGipFy9scpXvvEDfvTiEfbs3s4vffJBnvnUo2yZHCMNdabncv6vP/0a7VyjijeOgOIEgu9hxLJr5y4+/6tbOHJumhdfe5OlmRVEusytzvLE/fewe2wzgYDFsNpp887JM3zzhaOcPHuVhfll8J7JsQE+8fgjpGSE0GZsaBNf+rUvcPL0dU5+93vML65w9sRF3jt5HkLJ3Qf24esShYpiBHpFlyzpJy8hqEOMQY2nCB7nUoKG6HsZG4th1vyl2sN/etx2dBDUYyTeqA8eFUep8NaJk/zZ17/F7EqHYBy1rMaBu/YxsWmYTqdkZn6Zy9PXWG112L5nCuNSNBhssOTtHr5QSAzGJYgVVDxilF7epWb7KENJc7SPvqEmhABBSUgZGxojoc5aT/nzb7/Acy8cpdkY4JNPPsFv/cbn6K8rng6ZJLjNI6ROaUsgaKDbi45goMAoGBsTXGObxti77wCvvXUGn3dBHB6LTVJ8tbIcjqLXo93pcnV6nrmFdQx9aMjpawyzc3IXGY7cg0pBZhvsndoL/gcYSSBJGBwZ484DdzE4OISELgL4sqC0HusSVvMcq03ahWKdITWG4Hs0E4dU1UURwSu3AOBnp4o/AhDE/LcvS4y1iBGcTVjrFly5PsPSaouiDCQNw1//0mf48q//Mk2nmDKl27WcOP8+/+qP/jmPf+xRBEPHdwnapuNbFPQIIRZRREsSCdQkRbKMbjfH1eqs9ZZZay+ieQ+CwWnG9PkZGBvl3QvXeO7lY+TBsH/bOP/FFz7HWC1Bw1IM8QqlkJTUesT3MC4hhEBT6oQyULOOIhQETbDG0W73yDsFTlJ8yBkYHGFkcBRRCHgK9WwaGuIzTz3NS29f4PzpWcRYXEjoTxtMjm2iKNZpWIsYQy8vuXPfAZxt0glA6Rnp7+fOqSkcJU48DgVnySWat2dfeYn1XsLuqUNMTm6lbqGGp5V3cEYwoiTGkCUZZSgwN1V/uJl0MjfL+x8VCLTKoqGIxHLwRtmoKDyFD5gkY8vkJJ/9lV9m8/AgmXRJQ4aGOs2+/Vz8xOMcOrAXTMAmsc5vagaTWbz3lLmn0+4iiVAGxXtFbEJXSlZ7a3S67Zi/F0uapezYtZP19TWef/UI71+ZRjE88dCDjPU1SfIWicSsRmbq+BwGG03maANCWnO0/BrCcEwNSQzsPMryyirBpQSvKI5aoxnvNwSMjdVBVKnVEmxiMUmKI0O94oyhv16j7jo4cvKiTT0dodms0ajX6LZjBXFhYYmyKHCYmDYKJaolaqFA6RSB7z3/Mp3vHcGlGRI6DEmbL372kzz28EOkaUqgxFM5hT+nOfjJBeb/5KhSnSaJKWQ8XguMM9SaDYIaVB2ddc/01XnmZ5Zpr0XUJrZkfKDGkw/fx8TQEFYr8Ihn0+RmTBqzkK21LtPT0e4XCGocmJTcK51eSWutHeuS4jENQzKQMtde4q33T7LS6dDXP8Dhuw7SW1zh+qlL5HM5xVxg6cIKtbJOf9pX1WwKlBIxio2eHuJjZQ9V1lvrkHvAoVhqtSZZWiMRi4RAgpAaoQwF3ihqHL6MoeLAYD/OBURyoIczBcGvM9jM2Dq5OVIPcMwvrrK4uhazmGVZpY8lzqyU7NtzJ1P79nNleo4Xjxzj1TfeoghKo9mHEUcZfAxE9ccjg5vFzo2q2EcFgqoWiMhGSAJKgbMwtnkTg4MDaDDMz67w3e+8wMJCh/W1wPTMPDPz0+S9FlOTE9AtERV8CKz11tm5dyciHqxlebHFuXNXKLCUxqEupTQpeWlYWu6wvtaNSRhbkg0ltKXDxYUrXJy7hrfK4NAw+EB7aZ3Oiqdsp2i3TntJWZ5bx2Kr0n7A+wKLwWIrL9vHApEPdDs9xCuEgLWOZqNJlqQYkWgU1eOsUPiCMkQnrQgBTYTRsRHElKj2QAqs8WhoM9h0TO3eXgnFsLreY3ZhiZJY4VTAGHtTc0/t3ssDDz5CksW8wK5du/hrv/ar7N+/H+ssvgLBT1MA8mE0fDQggMh+8QpeA1ZcdBLpsXvbGPfctYc0NQTgvZPn6OaOtbbw8htvcvTEca4uz+BFWFhYpig9wRvW19bYPjmBDQWIYXmlxbunLrLaMxSS0lboYemUlguXpul2CoKWqC0Y2zqMF8O56WvMLC6Cc4ixPPfciyy3CybuuAsd2ERjfDvbDxzknbOn8FqgEhBrMZLS6xSY4HA4rDhEHN28oNvtYRp9lL0O9VrKUKOJQSmKHqlxhLIghEBZlOS9XpzozGIyGNo0gBHFmiplFAr60oQs8+zesRVjo70uipLZuVmMKDWXUWpJqZ5EEhwJ3VBydXqWK1evYVF++ZmnefLxx+hv1jFGSZPkg/Sz6s/KKP/EcXt5AoRgfESeSSmlxKIkdNk92c+Xv/AMl2dmOX9lkenr1/if/9ffY/+eST73a59k6tAu1kOXzKaMjk9x/uolJoeG2DK0me9eeoVtO7Zy9tISPrd8/0dHeezhw3zmqUcI5KgIN5ZbnDp9mbV2G0kchDV27Zxgodvh6sxKxfETLl++xMr0RY4ce50dU9t55OEHeOZjH2dqcgt3PHWYrW//kGMXzkHpsGUd062T+BpCD7WBQML80iq+CPiihyZCksDIYIPERHVdFgVOLIih187JW0W12AokzRmbGMSghGBQTbDGgpYMuZSJ0RFCRXAQhNbKApDjTR49fQwWg3jL2krOm2+9R68oGR9q8LH7DpBRYrWMflml7j8wBebnAsJtgSAWPiRWDwU0BJwxpGIxtuThQ3v57b/1Rb76F8/z1junmZu9QZ6vs9BaZHhTk6HRQSbGNvP5j3+SneM76JMAoccvPfE4AxM7+Kd/8Kdcv7bIaqvDv/5/v8KJkyd58KF7yZr9PPfSMY6fuIC6Glp2wZTs3DbJervH9PV5nK3hfWD33il+6zd+lePH3+Da4jTffvlZXjr6Mn1pwv/0D/8RK+vrYCwqDmcNR159g21Zm7HRhIHxYcpSmJtdoL3eis9XS+lrNtg0NIBIIHEJGkowlqCGdjsn71bkWykwiTK0aRBEECwWgwYPwZM5oVlPqddT1tuClrC62sKHgJeKOGIcRQAxDU6fPsWRN95EEsdTH3+UnRObcFpgb7IEKhDcjjBvFwRUAAghhjMGAz7aJRM8m5pNnnn4bqwoI4M1Tpw4x+JamxPHT2GtYWh0lGZfHb9U8puf+zRjk8OgOTsnB7DDdzK9+DTff/YNLp65yOkzl1heWePc1TmygX7OXrzO4nqJkIDxWJexZfMkUjq6az3Ex0LMxPgIn3rqEfbuaHJl5gqzMzMcO/ImZ09d5I//6KtcODcNmqFiKbSgF3r0DTawqeJLQZxjfnGesuyBlmiwpC5loG8QDbECGCSgYsgVlltt2p1ela/3GCtsGh+tSsWCw1D6WDrGQd9AneHRIdrdVTQYFubbdNpKf92xUXorSVjrwVvHTzE3t8jASD+H7z7AYF96Mz/wUYzbBEEEArpBhQT14AUkGBJbMjlY41eeOMzm0T5e2LqJ46cucvXSDEsLayzP9Fi4sc63Zp/lwJYxDmz7GIkp6dFirNnPFz77BPU04Y2hAa6cv87iyipHjr5H/+ZNmKyPvsFRWvNLiE0xJGzZvI2EDBMMlB7jLIlV+rLAgwd3cf/+cdQrPxod4+2TV3jlhaNMX1kCWwcNlFLS2NRgfMcYUrRodwq8BOYX5inLAoJHVUhcwkDfIKCURDq5F+goLLbatNa7lf+lWJTNmyIINChWDJ7IVwwmMDTSz9atm5m+voqXhJm5dZaXc8azJtYGCqA0KWev3+D1N49jxbBv1zb2T20ncfwYve2vMm6TWeQJIZA4i3qP94q1NdQkuIpP47VgcyPlqQcOcc+huzjyzhleP/IuL7/yNhcuLxM0YWmpzZtvHedvfv5RDB2sycnEMZIlfOlzT/GJhx/hlR8d5e133uX6/Dy77jxAaRu8c/Iip5dW0TKn8CVj41tYm1vG2SQW0VVYX2/R6i7T1xBqLhI2PvfMk3ziE4Ns+g8/5MTv/+tYe1BDUstY7ayy5tv0WU8n79LJhZnZOdrtHDC4NKHZrDMy0MQZUPUkNqOjUIhhpd2l1e7EwroqtvCM9vVhaIFWDpuJtY4Cz+joADsmN/H20TOoS5ibX+PG7Cr7xwYQDF6hHQwvvvEWb73zLkNDg3z84fu4Y+ckUDmgv0gQiChGCkofMMaRmD56Cp0yeqriA0ZLJOQMpg2MCzxxcIrDB/aw/9Ae/vE/+RPmFnKKkDCzsEoQg1FISFj3XTLrSbG4Ec8Xf+UBvvSp+1jvdNDaAKeurnDm3VNImaOqJFnGWmsdSS1DI6OISymxXLp8g+WVNsNpRt0GEmPxBGoGHnzoEPWapbseAEtvvcfla9fBGgrtMTBaZ/76Ou9fuEqrXYKpUxZdssTT1y+gHaSiz/WCJ/eWueVV1ntFtP8B6ir0Y3EhCitHKa0hiFDiGeirMTbcxFBijGVpdY3Z+QWCTBIU1Djen57ntbdPkTX6mBwf5eCubTgpQP1PC/lva9xWiHjTB5XIGCoIdDwYO8ilmVW++u0fcPnGEmVFzqxRMlSDkT7H4XvvYGzLcCwPJ5YkSWIFXSwYh2hKRh1BqVtLowFD/cLOzf2MDybcvXOCzz75AJPDKSltQt7iq1/5d5w6c5L+wb5IKqlCzBePvIXaJjkZPbV0MawUHf782/+Rbt4BLSIRJkl5460T5NTA9KOS0BwcZHB4FGNSCFG9pyJkYnBBSNTiS6Vmmvg2zMzME8qqmCMwOjSIAYyCFUNQIYQ4e4ZAzVoGagnORq3Z6bWZX1lGjSWIpePhyNvv8d6psxhruOfgPg7u247TEnu7kf1PGbenCYLBaIYxivceL4ozNa6ttPjKt37A28ffZmxyO+MTE7TKNol4EgyFCv3NGmmiQBcnsHv3JCpKGQxGEyBDqRGoEjZ4CinAgMEz3LB86pE7GTCfZ2ZpgYvXL3P9ylmKvEPPg0kgaEGvF/jBy8e469AB7p2axKIsr/c4+u5pvv/iK0xs38rFyzdiO5da5pdz/vkf/jlb+y1f/tJnyeopSZaBBkTBBjC5QAdSSUiMJXjFmoyl+QVuXJ2NTS4C3sLE1gli3jAmfYyC8SFmJQFMYHSgQV9fRqvbwdNjYW2B0gilGi7emOf1t0+wvLrGrrFR7j24h7GhOklkM/KzSCL/v4AAjf2EVpQQAtjI459emucb3/0Bi6urHHv/Ivv27WMgMTRspFAFhKtXrrG2sojoOpuGh3nwoUPR0yahV1pefeM9vKsTjFAUHYx4+gfrjG4aYGJkFEeXfduHObDzM6znHU5cuMAbx99lrpVTb/YzOjbI7I1lFMs7J8/z77/3Ejfuv4vUWuZXVvnRj16jEMuTH3+cq1/9GkWRgzpqjWG+8a1XycpV9u7bz9adUxUMfeRHqqHsBNYW2gz4DJvFZpO1doezp89z/eosiI28Cqts3b4V0cgTkhDJpU4tTiMpR6VkfGSAkeE+ZhZbqJQstpboAbkX3jz1PifPnEeAO/Zs4579u0ilxGEJN7mIv0AQbDDeCIHMJYTgaYVVUhPQ0KPb6/Gd515kx66dPDy1n7bNsepZK0u+9Z0XmJ6+gTE9Hn7kbh564G5ES1JXY229w//x+/8naX0Ak6SsrS4ixrP30H4efvRBHrj7EH02pVlPERvIasrhA3s4dOBOWsFwfbbNuQsXeX7xKGUwtFdz/sM3n+Xr3/gmfY0awXvWl1f54q//Og89fC9f//qfUXR6gDAwOMAnPvY4R195ln/yL/4lv/Gbfxtchkkzim6J4mh1Cq7fWCALfQz1Z6ircfriVV58+Rg3biyCyUBLrAYmBkfIFJJgKgaxIMYSNETWZQhsGR1ibHSY05du4IHFdovVUlltlbz21inmZuZJneGhe+5k/85tBL8Mplb1KMhHxTi/XcewxJoeKPhgsCI0LdyxbYi//9/8Fr/3z/6QcyfO8b/87r9gy6Yx9uzYSsMqp85d5czFa+RB2D21jb/3O79F01mgxKsnqzt+/5/+biR2io05ewJFmnBjdYU//fpfsDA/x9/9r/4O2zdvxpKTAcF36Lc1tm8e4JmPPcbp9y9z7coCxtTxLUVVWGuvA57MBF74/p/z8gvfpt1eAdsPKqyt3uA3//YzfOrpKf67/+F/5Js//AFdbRJw4DJ6RU5XDNqoMbJzG0YLWnng2nKLoycv4kmQEJCyJC16lPOLNEvBBgjW0gkecRYfyshCFJgYHWX7xBYsp/E+ML/U5spci7MXLvPmyfcpul3uP3w3T9x/N6IdMmshVA2rHxXL9HZBQFU4Vvmgt8Cq0nSeJ+49wH/7O/813/j+K7z8+knOtnrMzM1hfY9OF0QMjz98mL/15V9hbCgD7WGIRGwjgdHRJrEF3GJCLFcXpkYRSn756V9ievEGR44d5R1ruP+eg4wPD5PayEtMDNx/+CAHj+zhxrUZTLeFM4bhiREOHdrPfQfvYPeWYWqJ5drCAv/4X/3fLK8JFCXtTpvLV88wtWuS//4f/APefO8if/HtlyglARGCdcysrvLCsTfZvGWYkaF+zt+Y49svvcrsWitm96zFiiMJjnsO3sfxd88wMlxndGIzpU2xklLaCHorQlavM9A/iLEJqjUWFtu8dPQkZ85fYHZmiXq9xuMP3s328VGSjdY270ltSon/WQL6ucZt5glicSiIIVRduKKBRAMTA02eeegwjUYfk1u2cuLcBVZWVpBS2DoxwB17dvPk43fx8Xv3kkqPTJMobFFUPB5PTIHaqpMXXPCMNTK2DG9i68QQJ89Cq9Xi6vUbnD59kfW1Dr1eDy8G12iyZbjJr3/2E0w0BlELjU397Nm9kzt37mTr0ADGGk5dn2Z4sJ/llRWQhDIPXLs6w9nTp+nmKZcu3WBxcQ0tHNgUfMlKp8cPXn2DQoTxsTFOn7vAe5eu09g8yrquUnZik4knoT48TtlIWCg8Z945y2qrRV9/P2M7tlAfrNPMMoyrMTIyjsVB4ViY6/DDHx1jbmmRXq/kwJ5JHjt8F0P1DKPdSGknELcB0I8sU3CbmsDExgwMvuo+MhhM8DgJbGo4PvnQQfZNbee1t48zM7OIQRhqNjl8cB93TI3SlDY2QIaN4RNa1cNjd9PG/gCxAJMzkNQpQ5tNmeGxuw+y3Frn3MVrnJ+bZ35+hdX2GobA8HA/h3Zt454772TvlnFKU1BYT2IsdRxZ6FEEi3PKYH8faGXLvWOof4J333yX6zPLLK8HdkxO0l7tstBpUxQ98tJz8vxFFlbWGOgf5PrsLCbL6B8exGQGXc8BIRjLkfdOMbV7gkDBlfPv01lZY2BwgF2lYgZrWFWKtYLZmQU090hpWF/Kefed83jJSZOUB+45wIHd23CqiApBLNaCD71b2tR+QSDY6NYNJvbqCbGPbqNhMpGSpgns3jzAtk8/Ge2qCmlVbnZ0UN/DhkjZcjYlNndsdOTE61mNfUDOWgrfRshIxJJYg+trMHzoHu666wGsadDRLnUjWC1IEELepm4Kgi0pjY9UNZ9jvMWYlMw5ms0+sA68IOJ45KEnuGvPLk6cOMXFK9OQNJhdbPHK669z9foyvW4PYx3tXovCd6k1LEFzVmYuU+aBtOaoiSMTx7/54z8kyeDwA/fw0MFD7J2cxIqwvrLCxUtnuXD6DKePvUvX19G8izEpIfcVu7jN5u2DPPHgvQw2UrS7Di62tTkDed7FuvQXCwIIeBPJpRs9NgFFq7bvxBg0KHneYrDRTx7WKcsC42ITpWIxNAGLsbGwgo0qzvlI8jRqEBSVEmMcPvSopxn4gC9yEiOgOUNukLZfoN8KCRJ5hCXUkiTSxDRW5ZwIzlmM3eiWsrgkgxC3u1H1zC/Psmt0kB2P3UPvoTtodQvENfjtv/lp/tH/9r/zymuvsGPrdr7wxc9zx74phoaHGXQjvHz0Nf7gj/8dE9t2kuYltNaZvbbGgbv28Tt/98vs3LyZmlcsgs1SFvIO5WOPcu7wCY69f43vvfkux89dIcv6KXyOuMAD9+7nrr3bsNrD2thxVBJwEkit/Qg9gtstJccAMYpT/c13YgewRqaOcfRlNXzZI8GTmEARcoxNQS2JqVP6bpVS04qrV23iUJEi494ijtJ7nKujKvigOBObSEUDIj2cL6jbGt1yDWMUQ6whBA0YEyueqoHcR06iN4b+WsqTDz8IvsGVK7PMXDvP0swF7hidInM9+lJDMzGstJZZWlzh7/2Xv8HTjz/AxenL3Hf3HUxt3U4tTfGl5xMP3cvYaB+mUaNPUuo+ULZbNPsaTE2O0UyEugJFiSQem6ZAky0P3sveQ4eYPLCPr/zH73PmwlWWltbYsmWYRw8fYLiZYaTEWkse4iYbZenJjPkoSwe37xOAYELAkt/Skm6qhlRDQEkENHiMEYxU9XcNaBC8lKhR1IRqi5YYEQix3T1I7NQLEpMjRgwlEicCX7WgC8HnpMYiwZMIQIk1RNqbSWJzTHV9lcgfQIX+xPD0fQfYuWkzcwtLrCzNsGs4w4Y1LHE3kJo1lKljqJEyONSk1VohDz0atSb92SBGStQEBob62Xz4ELnxZCYhE8H5WF0txaPai30NRvG+RFyCq1lqSZPEZchwE9uwvPnuSY6//R47doxz+I5d1JOYJY37QcSW+6Cg4WbP2S8OBFrtuGE0x2mOpSCIUJASTEqQyHtjoxVd4kYWpkowBY0PhQ0E8TFFrK46pup5NgFftYYbNZRV/t4Y4iZXlBhx+KAkNqEMsfEioBjxlOoRYyBEEIgkBJPgSTEaaEjgwJZh9m0ZJggYG8hCThm6GNO4Cbz+RpOs0eTa3CIQmNy6ncQ2WF5eJ5RtkqJgZKDGYD3BG/ASOQUmgLWOQgvAx51QrKEsY1e2SSw5AZUem0cyPvnUA+zZu5X9O8cYHupj58QwqSgaytjjKDFLKGLRoGB/0WnjqvMnavKAw+NRCrEV91gxJm68EEKOhtjGTRCMiYTINEnphfZNEDhJidu5RFasonwAI4mr2wd8KKklCUUoUOJOaECVuCpj+CSCswavJUZiylqJ/krQSOhKEQhdUhvJ2qji8zXqWR/dUGIki99XbXCxY3wrg+PjeGp4FY69fpRybYXe0hxPPHg3A9vGkeARqyAWa0A10u6ctVii+Qoam0d7ZYGxKSIe9QXO1di1bZx92yZBC6wUuCqJpiIVoDyJTatezp/OHv55x/8HnerHBxpqEp4AAAAASUVORK5CYII=")
        r.addBodyPara("typeId", "35")
        r.addBodyPara("convert_to_jpg", "0")
        r.addBodyPara("needMorePrecise", "0")
        r.addFilePara("image", r"F:/imooc1.png")  # 文件上传时设置
        res = r.post()
        text = res.json()["showapi_res_body"]["Result"]
        return text

    def main(self):
        user_name_info = self.get_range_user()
        user_email = user_name_info + "@163.com"
        file_name = "F:/test.png"
        code_text = self.code_online(file_name)
        self.send_user_info("user_email", user_email)
        self.send_user_info("user_name", user_name_info)
        self.send_user_info("password", "111111")
        self.send_user_info("code_text", "11111")
        self.get_user_element("register_button"). click()
        # cede_text_error有值表示验证码出错
        code_error = self.get_user_element("code_text_error")
        if code_error == None:
            print("注册成功")
        else:
            self.driver.save_screenshot("F:/code_error.png")
            print("注册失败")

        time.sleep(5)
        self.driver.close()

if __name__ == "__main__":
    for i in range(3):
        register_function = RegisterFunction("http://www.5itest.cn/register", i)
        register_function.main()
'''
class RegisterFunction(object):
    def __init__(self, url):
        self.driver = self.get_driver(url)

    # 获取driver并且打开url
    def get_driver(self, url):
        driver = webdriver.Chrome()
        driver.get(url)
        driver.maximize_window()
        return driver

    # 输入用户信息
    def send_user_info(self, key, data):
        self.get_user_element(key).send_keys(data)

    # 定位给用户信息，获取element
    def get_user_element(self, key):
       find_element = FindElement(self.driver)
       user_element = find_element.get_element(key)
       return user_element

    # 获取随机数
    def get_range_user(self):
        user_info = ''.join(random.sample("1234567890abcdefghijklmn", 8))
        return user_info

    # 获取图片
    def get_code_image(self, file_name):
        self.driver.save_screenshot(file_name)
        code_element = self.get_user_element("code_image")
        print(code_element.location)
        left = code_element.location['x']
        top = code_element.location['y']
        right = code_element.size['width'] + left
        height = code_element.size['height'] + top
        im = Image.open(file_name)
        img = im.crop(left, top, right, height)
        img.save(file_name)

    # 解析图片获取验证码信息
    def code_online(self, file_name):
        self.get_code_image(file_name)
        r = ShowapiRequest("http://route.showapi.com/184-5", "96517", "213a7970dd72492aaaee595c9d64f7d9")
        r.addBodyPara("img_base64",
                      "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIEAAAAoCAYAAADZs5l2AAAmqElEQVR4nMW8eZBd133f+fmdc+69b+m9ge4GGmsDIAgCJMF9k0hRlGRbkp1IcqzUOPFkMi5Xav6dTM1MpWYqmarx1LgqVZmMK8vE8czETuwqyZEiK9ZOkeIOEuACEjuxA43et9dvufee85s/zm0QtJZEMGt0qrr79Xv33nfv+X3Pb/3+jsz4N5SfewREffVaULGgloAFLKipPlKMBpASRQkieLGYYPFaoqZLKp7Mg1eHsSmJ5njjWcpXSbIBSnVYTckMiF/BqGJNjY4PqLMEcRAsGRllsU6WQp4HbOLwpo2gqBoIFicJiiGUJSYE0iyh9AXOOPK8xNoELwaVQBBFRTHqUQHFoAhGDQoEAasKBFQUkRKjCiGNc4CClHEe1IAISA6SIwQIKap1VISAAc2qc3pgcsAjIQUEQwFSIqqgNdAEFQ8S4uWrnw8PBVFEQSqZxeF+7Mgff+c/awiIAdX4GgXxiAqKIiK3HBrizYuiGl9bY7AIJQZVTxmUoJ6gJc4IRe5JkybdoBjJCFKj7Xs0TJOe72KDJVhHgaA4jCS0PRhjsJQYC8GXqIKIxRgHCMErSMAYQ2ItZVngNaAhxyZpdbze/ItqnEAFlY3JjM8st0y7oPEYJApbBWRjbgARZOMCKjfPiucFTPV3Q3Cqt4pUUEz8u3Edbpnfn2uYn/jubYNAtUI7cbIQj0h8EKmOAdmYM4SN9aGY0EMBYwVLiljFqlCWAcRiJAMcXoRWaShKyHNlqOlITIOMGj3xXLx2jU7X02wMkGUZW4abSMhJRUnEodTRAKoCqiihAmlcF149xlhUA0FCfBoVpML1TRkCsgGI6n+9+b9Wvw2hWhxaTfYHQBGMgKiJi2fjKqoYKavXpnrLo2g1s4IiBDFRVKKIWASD+UtA+HFYxLm/9R5+2rh9EBDRLlQrPU5rBYRwy4PZSiVVty0gocQHAIuQYBDECN6UBCxiaqx2St6fnuP87DxLrZIiLxjdbNkxNsa20Ulco8ZLb53m0sXr9A8OMja+mc899QhDDhIJ2EqLFB48JZhAlEQgEFAN1e3F+yxCiTUWrx6HrQRfPavoLWsornqRDSVcaQExiJqbS4DKhIhunKUIhrgUZGMiEDxGNQJHDYonyAawNuba3PxuFYOptIl8SEP9ZDndvOePGgSqUTVtXDj+NkThbyAvql4JBqrJ0OozY+NZZSkUvsQXijiDzVJ8cLQLx+mLM/zRv/8Gr719nBvzyyie0YkaD91/mKcefZqpPft5/tV3eeXl11At2HPnbh66/06GNtWRoOS9nNTVMEEI1cpXibcZVG9qgF4ocCal1BIrNdTkG1q50twfVgtRPhvq+4MR/YO4GIIEUAjILVNffbm6m8KtJiXOS1QvfCCsD840Gv2T6IuFD2mgj2LcHghkY60LEqIzKMHGhxIPlNVNw01HUQ1GlFJLirIgdQ3qpp/W6iqXT11g85bNNDYPQ62PK8tt/uBPvsnLr7/HeqdDvZaR1ZWFhXmeff4VXnnxFNbW6XS75F2Ls4E0SRgeGkS1xJeW/lofnfUWaZZircHjKSthBqJ6t+LABjyGYCzrvkdi7S043gA7oKY6UzEaFXUQra5osMHj1N90GgMGL3EBfCBQi2IBUzmegWBC1KbBVmZoY3HF74EQHUAtEQ3R0VYbTcWG6/ET5PPBkJvPDD/ZK7g9EBBV6U2vN8QHE63sqggQX1NNRNgwH2IRlB4eEwrqWY09O3dTSEkeoFN6/tm/+be8evQ46+2Svdt289ijBxmb7OP66hxH3zzB+TOztNsriMtIbANLh7pNyazDSkDEUYZA1shQCXgCJYIXh2AoJUGAQgMGiwLONOgVbRo2I0gPUwEg2mO5KSC56Yt/2NZK9fxRxccFYm6x7h9Ix6EStaaKr+bKYUQQBVNpB+QDMETvIALAVBrH47hVW/xVxu35BOKJuqCy+bd4rRuhVLjpkggiJmoNfLxtI3gNBMnJ0oT6cB9rvksndRw9d4YfHjvCQmuV4WSATz/yMJ/99KP0jTjmixYHdu3n9aOnef6lt5hfWscEiwSh4Wo4JE6NoVLzIWoATfEmJRcHOASLV6X0XVIRxMT1bG2dIihOhCCCisFjAeJTVR6jVE7dTd8oWvboFIpHRW/RAvHTGGnExYEKIh6hJBAqXyFEmQa9+R0fwCeaEq0ilzh+hp3/0Efyl/7/cdVxm46hAr4SdfwiqVa7iuCFGG/f/CwCwYSYN/DEWFytxysUoSRkljxxfOu1F5lZmUPSlL3bxnjynoPs2zRCbciwJRlg7+Qupib3cmNujaUj76I+IF7przVwCkbDTTVbUBLU4NWw3Mq5vjhPq9UjoUYvlBR5h5SAtQGRgnvuuotCSqypvHIsXhyKYDXmAjbUtNkAygbwjcGroEbi9+MQlbiCCdFhDhvxEQTRKiKJoo45iQ8U9wcWqVpcYiphVhLVn64Fbg1rK3X8l2T3kYCgcnI2vNyNVS8a/QWBUirbi0GIYY01jiCOkhJPiQW88RRW6dqUVV/y7Cuv4DttskbGE48cZttok5mL59h551bqNsOYwN1Tu7nv4EHefPssvuhhcAwNNnECpS8Q4zE2paCOD46ltTZvn36f518+yvlzV0ETeiEQihzptjEmp9k0/N7v/kO2jgwRtEsIiopQGIfiAM+GWTBGkQBe9OY8KAaVarWKJWDisdWqFiAEJe+V4BLEJmilGS1S+YkxfJUPCU7hVrBVHquK8NNh8PON2wKBqEM0QTTGq8EHUI/LMgpKvAg9LRFJKTRQl5hF60nAUkcIeNpAjpcCHBQinLlwlZW5VUhqDPTXmdo5zp6pCSQMUtDDFAX1JKMoSurWYa2jKx2SmmFk8xCm0i4WoR08wYxyY3WVr3/tuzz74ktcvbGA7wndjhDSDBuUzOcYWeeOfePkeY7iUVXml5aw2QDpQH81TYEQFGtjpGks9MqcxCUQhKARFBuJnU4IpCbFErVBqYH5pTVefu0426buZNe+3djEUAOSUFAzFqUXFwtE0yNKWQRqSY1cK1e8ykflRUma1ghBCb68+f6tvkpM3t2UGj9JC/wVQGAwYqv8gEbvW5U8BHoK3iZ0S2Gl3WZ2YZHZq3OsLK3isjqNRn/UG9pmz84R7tyxBQngkjpnT16kzB0Epa9eZ+u2MUwWIHgcQtHrcOP6AoPjeykLjy+KqHXwjI+PVqrXkmtApI8Xj73Hn3zl61y6cI6ZhVlsVmN0dAxj+jh7bR5bBIQE9fA3/sZvMjwwgCHgRblw+TLf/M4LzHcC45M7Obh7ivGJEcbG+tmxaRBxgrUJpSqJSfDB0AVKVYrcM7O4ysyN64yN9rFrxziJZCy3F/ne8y/S+eHrjO/cyradExzau5eDU7sYrSekAiol3nvEx1Cz5jK6vouxFlXIixxrhNQ16ORdUpdgJKbhE2PwIXw4Y/ufMW4PBOIr5zWg6jHiUFWCWJSM0xevc+y901yanmFpYZnZG/N02x1skmHTGs5ZRNfZPzXE3//tv0MNh/UZV85MY4oaEgyNeoPRiU3kpsBQkFrBF0Ity7gxO8ulS1fwQcAYjIUtoyPEDFSKSsLLb5zi337tuxw9dpytY3185peeYuvkVgbro6y1hN//f/4M7xUfAtbV2HfHfvrqdVTXCeoZHtnE5vGtPPed5zh68iKnJs4yMtJg/4Ed/NonP8busdEYGGmglxecvTrLyas3mJ5dYnFpmdXVdXqdFT799MPs3L4VBTYNjPLIw4/ytb94jhMXLjI8NsQ74yfYP7Wb+/ZP8fA9+xmpp1hClQKHIuQggvcBa1KMKCKBUOUwvCrWRBusqj8DAD89r3CbPkEsIIkJaAgE1VgEMQmLiz2+++wRvv/Ca1yenqXoFdQSR1+jQV4GWr0cH0pCWGdpeYgSi5UUGxxL11exeYoYyGoNmoN9FKYgoUAxJKljZNMAZ09dY3putrKohsQ6JkfHccGipFy9scpXvvEDfvTiEfbs3s4vffJBnvnUo2yZHCMNdabncv6vP/0a7VyjijeOgOIEgu9hxLJr5y4+/6tbOHJumhdfe5OlmRVEusytzvLE/fewe2wzgYDFsNpp887JM3zzhaOcPHuVhfll8J7JsQE+8fgjpGSE0GZsaBNf+rUvcPL0dU5+93vML65w9sRF3jt5HkLJ3Qf24esShYpiBHpFlyzpJy8hqEOMQY2nCB7nUoKG6HsZG4th1vyl2sN/etx2dBDUYyTeqA8eFUep8NaJk/zZ17/F7EqHYBy1rMaBu/YxsWmYTqdkZn6Zy9PXWG112L5nCuNSNBhssOTtHr5QSAzGJYgVVDxilF7epWb7KENJc7SPvqEmhABBSUgZGxojoc5aT/nzb7/Acy8cpdkY4JNPPsFv/cbn6K8rng6ZJLjNI6ROaUsgaKDbi45goMAoGBsTXGObxti77wCvvXUGn3dBHB6LTVJ8tbIcjqLXo93pcnV6nrmFdQx9aMjpawyzc3IXGY7cg0pBZhvsndoL/gcYSSBJGBwZ484DdzE4OISELgL4sqC0HusSVvMcq03ahWKdITWG4Hs0E4dU1UURwSu3AOBnp4o/AhDE/LcvS4y1iBGcTVjrFly5PsPSaouiDCQNw1//0mf48q//Mk2nmDKl27WcOP8+/+qP/jmPf+xRBEPHdwnapuNbFPQIIRZRREsSCdQkRbKMbjfH1eqs9ZZZay+ieQ+CwWnG9PkZGBvl3QvXeO7lY+TBsH/bOP/FFz7HWC1Bw1IM8QqlkJTUesT3MC4hhEBT6oQyULOOIhQETbDG0W73yDsFTlJ8yBkYHGFkcBRRCHgK9WwaGuIzTz3NS29f4PzpWcRYXEjoTxtMjm2iKNZpWIsYQy8vuXPfAZxt0glA6Rnp7+fOqSkcJU48DgVnySWat2dfeYn1XsLuqUNMTm6lbqGGp5V3cEYwoiTGkCUZZSgwN1V/uJl0MjfL+x8VCLTKoqGIxHLwRtmoKDyFD5gkY8vkJJ/9lV9m8/AgmXRJQ4aGOs2+/Vz8xOMcOrAXTMAmsc5vagaTWbz3lLmn0+4iiVAGxXtFbEJXSlZ7a3S67Zi/F0uapezYtZP19TWef/UI71+ZRjE88dCDjPU1SfIWicSsRmbq+BwGG03maANCWnO0/BrCcEwNSQzsPMryyirBpQSvKI5aoxnvNwSMjdVBVKnVEmxiMUmKI0O94oyhv16j7jo4cvKiTT0dodms0ajX6LZjBXFhYYmyKHCYmDYKJaolaqFA6RSB7z3/Mp3vHcGlGRI6DEmbL372kzz28EOkaUqgxFM5hT+nOfjJBeb/5KhSnSaJKWQ8XguMM9SaDYIaVB2ddc/01XnmZ5Zpr0XUJrZkfKDGkw/fx8TQEFYr8Ihn0+RmTBqzkK21LtPT0e4XCGocmJTcK51eSWutHeuS4jENQzKQMtde4q33T7LS6dDXP8Dhuw7SW1zh+qlL5HM5xVxg6cIKtbJOf9pX1WwKlBIxio2eHuJjZQ9V1lvrkHvAoVhqtSZZWiMRi4RAgpAaoQwF3ihqHL6MoeLAYD/OBURyoIczBcGvM9jM2Dq5OVIPcMwvrrK4uhazmGVZpY8lzqyU7NtzJ1P79nNleo4Xjxzj1TfeoghKo9mHEUcZfAxE9ccjg5vFzo2q2EcFgqoWiMhGSAJKgbMwtnkTg4MDaDDMz67w3e+8wMJCh/W1wPTMPDPz0+S9FlOTE9AtERV8CKz11tm5dyciHqxlebHFuXNXKLCUxqEupTQpeWlYWu6wvtaNSRhbkg0ltKXDxYUrXJy7hrfK4NAw+EB7aZ3Oiqdsp2i3TntJWZ5bx2Kr0n7A+wKLwWIrL9vHApEPdDs9xCuEgLWOZqNJlqQYkWgU1eOsUPiCMkQnrQgBTYTRsRHElKj2QAqs8WhoM9h0TO3eXgnFsLreY3ZhiZJY4VTAGHtTc0/t3ssDDz5CksW8wK5du/hrv/ar7N+/H+ssvgLBT1MA8mE0fDQggMh+8QpeA1ZcdBLpsXvbGPfctYc0NQTgvZPn6OaOtbbw8htvcvTEca4uz+BFWFhYpig9wRvW19bYPjmBDQWIYXmlxbunLrLaMxSS0lboYemUlguXpul2CoKWqC0Y2zqMF8O56WvMLC6Cc4ixPPfciyy3CybuuAsd2ERjfDvbDxzknbOn8FqgEhBrMZLS6xSY4HA4rDhEHN28oNvtYRp9lL0O9VrKUKOJQSmKHqlxhLIghEBZlOS9XpzozGIyGNo0gBHFmiplFAr60oQs8+zesRVjo70uipLZuVmMKDWXUWpJqZ5EEhwJ3VBydXqWK1evYVF++ZmnefLxx+hv1jFGSZPkg/Sz6s/KKP/EcXt5AoRgfESeSSmlxKIkdNk92c+Xv/AMl2dmOX9lkenr1/if/9ffY/+eST73a59k6tAu1kOXzKaMjk9x/uolJoeG2DK0me9eeoVtO7Zy9tISPrd8/0dHeezhw3zmqUcI5KgIN5ZbnDp9mbV2G0kchDV27Zxgodvh6sxKxfETLl++xMr0RY4ce50dU9t55OEHeOZjH2dqcgt3PHWYrW//kGMXzkHpsGUd062T+BpCD7WBQML80iq+CPiihyZCksDIYIPERHVdFgVOLIih187JW0W12AokzRmbGMSghGBQTbDGgpYMuZSJ0RFCRXAQhNbKApDjTR49fQwWg3jL2krOm2+9R68oGR9q8LH7DpBRYrWMflml7j8wBebnAsJtgSAWPiRWDwU0BJwxpGIxtuThQ3v57b/1Rb76F8/z1junmZu9QZ6vs9BaZHhTk6HRQSbGNvP5j3+SneM76JMAoccvPfE4AxM7+Kd/8Kdcv7bIaqvDv/5/v8KJkyd58KF7yZr9PPfSMY6fuIC6Glp2wZTs3DbJervH9PV5nK3hfWD33il+6zd+lePH3+Da4jTffvlZXjr6Mn1pwv/0D/8RK+vrYCwqDmcNR159g21Zm7HRhIHxYcpSmJtdoL3eis9XS+lrNtg0NIBIIHEJGkowlqCGdjsn71bkWykwiTK0aRBEECwWgwYPwZM5oVlPqddT1tuClrC62sKHgJeKOGIcRQAxDU6fPsWRN95EEsdTH3+UnRObcFpgb7IEKhDcjjBvFwRUAAghhjMGAz7aJRM8m5pNnnn4bqwoI4M1Tpw4x+JamxPHT2GtYWh0lGZfHb9U8puf+zRjk8OgOTsnB7DDdzK9+DTff/YNLp65yOkzl1heWePc1TmygX7OXrzO4nqJkIDxWJexZfMkUjq6az3Ex0LMxPgIn3rqEfbuaHJl5gqzMzMcO/ImZ09d5I//6KtcODcNmqFiKbSgF3r0DTawqeJLQZxjfnGesuyBlmiwpC5loG8QDbECGCSgYsgVlltt2p1ela/3GCtsGh+tSsWCw1D6WDrGQd9AneHRIdrdVTQYFubbdNpKf92xUXorSVjrwVvHTzE3t8jASD+H7z7AYF96Mz/wUYzbBEEEArpBhQT14AUkGBJbMjlY41eeOMzm0T5e2LqJ46cucvXSDEsLayzP9Fi4sc63Zp/lwJYxDmz7GIkp6dFirNnPFz77BPU04Y2hAa6cv87iyipHjr5H/+ZNmKyPvsFRWvNLiE0xJGzZvI2EDBMMlB7jLIlV+rLAgwd3cf/+cdQrPxod4+2TV3jlhaNMX1kCWwcNlFLS2NRgfMcYUrRodwq8BOYX5inLAoJHVUhcwkDfIKCURDq5F+goLLbatNa7lf+lWJTNmyIINChWDJ7IVwwmMDTSz9atm5m+voqXhJm5dZaXc8azJtYGCqA0KWev3+D1N49jxbBv1zb2T20ncfwYve2vMm6TWeQJIZA4i3qP94q1NdQkuIpP47VgcyPlqQcOcc+huzjyzhleP/IuL7/yNhcuLxM0YWmpzZtvHedvfv5RDB2sycnEMZIlfOlzT/GJhx/hlR8d5e133uX6/Dy77jxAaRu8c/Iip5dW0TKn8CVj41tYm1vG2SQW0VVYX2/R6i7T1xBqLhI2PvfMk3ziE4Ns+g8/5MTv/+tYe1BDUstY7ayy5tv0WU8n79LJhZnZOdrtHDC4NKHZrDMy0MQZUPUkNqOjUIhhpd2l1e7EwroqtvCM9vVhaIFWDpuJtY4Cz+joADsmN/H20TOoS5ibX+PG7Cr7xwYQDF6hHQwvvvEWb73zLkNDg3z84fu4Y+ckUDmgv0gQiChGCkofMMaRmD56Cp0yeqriA0ZLJOQMpg2MCzxxcIrDB/aw/9Ae/vE/+RPmFnKKkDCzsEoQg1FISFj3XTLrSbG4Ec8Xf+UBvvSp+1jvdNDaAKeurnDm3VNImaOqJFnGWmsdSS1DI6OISymxXLp8g+WVNsNpRt0GEmPxBGoGHnzoEPWapbseAEtvvcfla9fBGgrtMTBaZ/76Ou9fuEqrXYKpUxZdssTT1y+gHaSiz/WCJ/eWueVV1ntFtP8B6ir0Y3EhCitHKa0hiFDiGeirMTbcxFBijGVpdY3Z+QWCTBIU1Djen57ntbdPkTX6mBwf5eCubTgpQP1PC/lva9xWiHjTB5XIGCoIdDwYO8ilmVW++u0fcPnGEmVFzqxRMlSDkT7H4XvvYGzLcCwPJ5YkSWIFXSwYh2hKRh1BqVtLowFD/cLOzf2MDybcvXOCzz75AJPDKSltQt7iq1/5d5w6c5L+wb5IKqlCzBePvIXaJjkZPbV0MawUHf782/+Rbt4BLSIRJkl5460T5NTA9KOS0BwcZHB4FGNSCFG9pyJkYnBBSNTiS6Vmmvg2zMzME8qqmCMwOjSIAYyCFUNQIYQ4e4ZAzVoGagnORq3Z6bWZX1lGjSWIpePhyNvv8d6psxhruOfgPg7u247TEnu7kf1PGbenCYLBaIYxivceL4ozNa6ttPjKt37A28ffZmxyO+MTE7TKNol4EgyFCv3NGmmiQBcnsHv3JCpKGQxGEyBDqRGoEjZ4CinAgMEz3LB86pE7GTCfZ2ZpgYvXL3P9ylmKvEPPg0kgaEGvF/jBy8e469AB7p2axKIsr/c4+u5pvv/iK0xs38rFyzdiO5da5pdz/vkf/jlb+y1f/tJnyeopSZaBBkTBBjC5QAdSSUiMJXjFmoyl+QVuXJ2NTS4C3sLE1gli3jAmfYyC8SFmJQFMYHSgQV9fRqvbwdNjYW2B0gilGi7emOf1t0+wvLrGrrFR7j24h7GhOklkM/KzSCL/v4AAjf2EVpQQAtjI459emucb3/0Bi6urHHv/Ivv27WMgMTRspFAFhKtXrrG2sojoOpuGh3nwoUPR0yahV1pefeM9vKsTjFAUHYx4+gfrjG4aYGJkFEeXfduHObDzM6znHU5cuMAbx99lrpVTb/YzOjbI7I1lFMs7J8/z77/3Ejfuv4vUWuZXVvnRj16jEMuTH3+cq1/9GkWRgzpqjWG+8a1XycpV9u7bz9adUxUMfeRHqqHsBNYW2gz4DJvFZpO1doezp89z/eosiI28Cqts3b4V0cgTkhDJpU4tTiMpR6VkfGSAkeE+ZhZbqJQstpboAbkX3jz1PifPnEeAO/Zs4579u0ilxGEJN7mIv0AQbDDeCIHMJYTgaYVVUhPQ0KPb6/Gd515kx66dPDy1n7bNsepZK0u+9Z0XmJ6+gTE9Hn7kbh564G5ES1JXY229w//x+/8naX0Ak6SsrS4ixrP30H4efvRBHrj7EH02pVlPERvIasrhA3s4dOBOWsFwfbbNuQsXeX7xKGUwtFdz/sM3n+Xr3/gmfY0awXvWl1f54q//Og89fC9f//qfUXR6gDAwOMAnPvY4R195ln/yL/4lv/Gbfxtchkkzim6J4mh1Cq7fWCALfQz1Z6ircfriVV58+Rg3biyCyUBLrAYmBkfIFJJgKgaxIMYSNETWZQhsGR1ibHSY05du4IHFdovVUlltlbz21inmZuZJneGhe+5k/85tBL8Mplb1KMhHxTi/XcewxJoeKPhgsCI0LdyxbYi//9/8Fr/3z/6QcyfO8b/87r9gy6Yx9uzYSsMqp85d5czFa+RB2D21jb/3O79F01mgxKsnqzt+/5/+biR2io05ewJFmnBjdYU//fpfsDA/x9/9r/4O2zdvxpKTAcF36Lc1tm8e4JmPPcbp9y9z7coCxtTxLUVVWGuvA57MBF74/p/z8gvfpt1eAdsPKqyt3uA3//YzfOrpKf67/+F/5Js//AFdbRJw4DJ6RU5XDNqoMbJzG0YLWnng2nKLoycv4kmQEJCyJC16lPOLNEvBBgjW0gkecRYfyshCFJgYHWX7xBYsp/E+ML/U5spci7MXLvPmyfcpul3uP3w3T9x/N6IdMmshVA2rHxXL9HZBQFU4Vvmgt8Cq0nSeJ+49wH/7O/813/j+K7z8+knOtnrMzM1hfY9OF0QMjz98mL/15V9hbCgD7WGIRGwjgdHRJrEF3GJCLFcXpkYRSn756V9ievEGR44d5R1ruP+eg4wPD5PayEtMDNx/+CAHj+zhxrUZTLeFM4bhiREOHdrPfQfvYPeWYWqJ5drCAv/4X/3fLK8JFCXtTpvLV88wtWuS//4f/APefO8if/HtlyglARGCdcysrvLCsTfZvGWYkaF+zt+Y49svvcrsWitm96zFiiMJjnsO3sfxd88wMlxndGIzpU2xklLaCHorQlavM9A/iLEJqjUWFtu8dPQkZ85fYHZmiXq9xuMP3s328VGSjdY270ltSon/WQL6ucZt5glicSiIIVRduKKBRAMTA02eeegwjUYfk1u2cuLcBVZWVpBS2DoxwB17dvPk43fx8Xv3kkqPTJMobFFUPB5PTIHaqpMXXPCMNTK2DG9i68QQJ89Cq9Xi6vUbnD59kfW1Dr1eDy8G12iyZbjJr3/2E0w0BlELjU397Nm9kzt37mTr0ADGGk5dn2Z4sJ/llRWQhDIPXLs6w9nTp+nmKZcu3WBxcQ0tHNgUfMlKp8cPXn2DQoTxsTFOn7vAe5eu09g8yrquUnZik4knoT48TtlIWCg8Z945y2qrRV9/P2M7tlAfrNPMMoyrMTIyjsVB4ViY6/DDHx1jbmmRXq/kwJ5JHjt8F0P1DKPdSGknELcB0I8sU3CbmsDExgwMvuo+MhhM8DgJbGo4PvnQQfZNbee1t48zM7OIQRhqNjl8cB93TI3SlDY2QIaN4RNa1cNjd9PG/gCxAJMzkNQpQ5tNmeGxuw+y3Frn3MVrnJ+bZ35+hdX2GobA8HA/h3Zt454772TvlnFKU1BYT2IsdRxZ6FEEi3PKYH8faGXLvWOof4J333yX6zPLLK8HdkxO0l7tstBpUxQ98tJz8vxFFlbWGOgf5PrsLCbL6B8exGQGXc8BIRjLkfdOMbV7gkDBlfPv01lZY2BwgF2lYgZrWFWKtYLZmQU090hpWF/Kefed83jJSZOUB+45wIHd23CqiApBLNaCD71b2tR+QSDY6NYNJvbqCbGPbqNhMpGSpgns3jzAtk8/Ge2qCmlVbnZ0UN/DhkjZcjYlNndsdOTE61mNfUDOWgrfRshIxJJYg+trMHzoHu666wGsadDRLnUjWC1IEELepm4Kgi0pjY9UNZ9jvMWYlMw5ms0+sA68IOJ45KEnuGvPLk6cOMXFK9OQNJhdbPHK669z9foyvW4PYx3tXovCd6k1LEFzVmYuU+aBtOaoiSMTx7/54z8kyeDwA/fw0MFD7J2cxIqwvrLCxUtnuXD6DKePvUvX19G8izEpIfcVu7jN5u2DPPHgvQw2UrS7Di62tTkDed7FuvQXCwIIeBPJpRs9NgFFq7bvxBg0KHneYrDRTx7WKcsC42ITpWIxNAGLsbGwgo0qzvlI8jRqEBSVEmMcPvSopxn4gC9yEiOgOUNukLZfoN8KCRJ5hCXUkiTSxDRW5ZwIzlmM3eiWsrgkgxC3u1H1zC/Psmt0kB2P3UPvoTtodQvENfjtv/lp/tH/9r/zymuvsGPrdr7wxc9zx74phoaHGXQjvHz0Nf7gj/8dE9t2kuYltNaZvbbGgbv28Tt/98vs3LyZmlcsgs1SFvIO5WOPcu7wCY69f43vvfkux89dIcv6KXyOuMAD9+7nrr3bsNrD2thxVBJwEkit/Qg9gtstJccAMYpT/c13YgewRqaOcfRlNXzZI8GTmEARcoxNQS2JqVP6bpVS04qrV23iUJEi494ijtJ7nKujKvigOBObSEUDIj2cL6jbGt1yDWMUQ6whBA0YEyueqoHcR06iN4b+WsqTDz8IvsGVK7PMXDvP0swF7hidInM9+lJDMzGstJZZWlzh7/2Xv8HTjz/AxenL3Hf3HUxt3U4tTfGl5xMP3cvYaB+mUaNPUuo+ULZbNPsaTE2O0UyEugJFiSQem6ZAky0P3sveQ4eYPLCPr/zH73PmwlWWltbYsmWYRw8fYLiZYaTEWkse4iYbZenJjPkoSwe37xOAYELAkt/Skm6qhlRDQEkENHiMEYxU9XcNaBC8lKhR1IRqi5YYEQix3T1I7NQLEpMjRgwlEicCX7WgC8HnpMYiwZMIQIk1RNqbSWJzTHV9lcgfQIX+xPD0fQfYuWkzcwtLrCzNsGs4w4Y1LHE3kJo1lKljqJEyONSk1VohDz0atSb92SBGStQEBob62Xz4ELnxZCYhE8H5WF0txaPai30NRvG+RFyCq1lqSZPEZchwE9uwvPnuSY6//R47doxz+I5d1JOYJY37QcSW+6Cg4WbP2S8OBFrtuGE0x2mOpSCIUJASTEqQyHtjoxVd4kYWpkowBY0PhQ0E8TFFrK46pup5NgFftYYbNZRV/t4Y4iZXlBhx+KAkNqEMsfEioBjxlOoRYyBEEIgkBJPgSTEaaEjgwJZh9m0ZJggYG8hCThm6GNO4Cbz+RpOs0eTa3CIQmNy6ncQ2WF5eJ5RtkqJgZKDGYD3BG/ASOQUmgLWOQgvAx51QrKEsY1e2SSw5AZUem0cyPvnUA+zZu5X9O8cYHupj58QwqSgaytjjKDFLKGLRoGB/0WnjqvMnavKAw+NRCrEV91gxJm68EEKOhtjGTRCMiYTINEnphfZNEDhJidu5RFasonwAI4mr2wd8KKklCUUoUOJOaECVuCpj+CSCswavJUZiylqJ/krQSOhKEQhdUhvJ2qji8zXqWR/dUGIki99XbXCxY3wrg+PjeGp4FY69fpRybYXe0hxPPHg3A9vGkeARqyAWa0A10u6ctVii+Qoam0d7ZYGxKSIe9QXO1di1bZx92yZBC6wUuCqJpiIVoDyJTatezp/OHv55x/8HnerHBxpqEp4AAAAASUVORK5CYII=")
        r.addBodyPara("typeId", "35")
        r.addBodyPara("convert_to_jpg", "0")
        r.addBodyPara("needMorePrecise", "0")
        r.addFilePara("image", r"F:/imooc1.png")  # 文件上传时设置
        res = r.post()
        text = res.json()["showapi_res_body"]["Result"]
        return text

    def main(self):
        user_name_info = self.get_range_user()
        user_email = user_name_info + "@163.com"
        file_name = "F:/test.png"
        code_text = self.code_online(file_name)
        self.send_user_info("user_email", user_email)
        self.send_user_info("user_name", user_name_info)
        self.send_user_info("password", "111111")
        self.send_user_info("code_text", "11111")
        self.get_user_element("register_button"). click()
        # cede_text_error有值表示验证码出错
        code_error = self.get_user_element("code_text_error")
        if code_error == None:
            print("注册成功")
        else:
            self.driver.save_screenshot("F:/code_error.png")
            print("注册失败")

        time.sleep(5)
        self.driver.close()

if __name__ == "__main__":
        register_function = RegisterFunction("http://www.5itest.cn/register")
        register_function.main()